---
title: "Function"
author: "Alice"
date: "2022/2/12"
output: html_document
---

```{r}
check <- function(table, gene.col, gt.col, flag = c("Alleles", "Snps", "Carrier")){
```

```{r}
library(magrittr)
library(stringr)
table <- tibble::tibble(CHROM=1, 
                POS=2:7, 
                ID = ".", 
                gene.col=c("g1", "g1", "g2", "g3", "g4","g4"), 
                gt.col=c("0/1", "1/0", rep("0/0", 4)),
                s2=c("1/0", "0/0", "1/0", "0/0", "0/1", "./."),
                s3=c("0/0", "1/1", "0/0","0/0", "./.", "./."),
                s4=c(rep("0/0", 3), "0/1", "1/1", "0/1"))
 


gt_to_num <- function(string) {
  sum(as.numeric(str_extract_all(string, "\\d")[[1]]))
}

table %>%
  dplyr::rowwise() %>%
  dplyr::mutate(across(gt.col:ncol(table), gt_to_num))

table1 <- table %>%
  if(carrier[row,col] > 1){
    carrier[row, col] = 1
  }
  

  Allele <- table %>% 
    dplyr::group_by(gene.col) %>%
    dplyr::summarise(across((gt.col-1):(ncol(table)-1),sum))
  
  carrier <- Allele %>%
  if(carrier[row,col] > 1){
    carrier[row, col] = 1
  }
  
  snps <- table1 %>%
    dplyr::group_by(gene.col) %>%
    dplyr::summarise(across((gt.col-1):(ncol(table)-1),sum))
  
  if (flag == "Allele") {
    return(Allele)
  }
  if (flag == "snps") {
    return(snps)
  } 
  if(flag == "carrier"){
    return(carrier)
  }
}
```

  
  